# Configuration for the Renkforce RF2000V2 DUAL 3D printer
# Note: This configuration is not for RF2000 and not for the RF1000
# Note: This is work in progress, not yet ready for production!

# Attention: This file is configured for use with an E3D v6 hotend instead of the original Renkforce v3 hotend!
#            The RF2000V2 is actual only working with the version from  
#                    https://github.com/RF1000community/klipper
# The menu is configured, but the extra keys are mostly not working. Only the "continue" button (the one which looks
# like a play button) has been abused to create an emergency stop button!

[mcu]
serial: /dev/serial/by-id/usb-FTDI_FT232R_USB_UART_A906KK9M-if00-port0
baud: 250000
pin_map: arduino
restart_method: arduino


[printer]
kinematics: cartesian
max_velocity: 150
max_accel: 1000
max_z_velocity: 10
max_z_accel: 70

[stepper_x]
step_pin: PF0
dir_pin: !PF1
enable_pin: PD7
# 10mm slope, 200 steps per revolution, 32 microsteps: 10/200 / 32
step_distance: 0.0015625
endstop_pin: !PC2
position_endstop: 0
position_max: 170
homing_speed: 10.0
second_homing_speed: 5.0

[drv8711 stepper_x]
cs_pin: PL0
spi_software_sclk_pin: PD5
spi_software_miso_pin: PD4
spi_software_mosi_pin: PD6
current: 2.5

[stepper_y]
step_pin: PF6
dir_pin: PF7
enable_pin: PF2
# 14 teeth each 3mm, 200 steps per revolution, 32 microsteps: 14*3/200 / 32
step_distance: 0.0065625
endstop_pin: !PC0
position_endstop: 0
position_max: 290
homing_speed: 10.0
second_homing_speed: 5.0

[drv8711 stepper_y]
cs_pin: PL2
spi_software_sclk_pin: PD5
spi_software_miso_pin: PD4
spi_software_mosi_pin: PD6
current: 1.8

[stepper_z]
step_pin: PF3
dir_pin: PL1
enable_pin: PK0
# 5mm slope, 200 steps per revolution, 2x step-down via belt, 32 microsteps: 5/(200*2) / 32
step_distance: 0.000390625
endstop_pin: !PC6
position_min: -0.8
position_endstop: 0
position_max: 185
homing_speed: 7.0
#second_homing_speed: 2

[drv8711 stepper_z]
cs_pin: PB6
spi_software_sclk_pin: PD5
spi_software_miso_pin: PD4
spi_software_mosi_pin: PD6
current: 1.8

[extruder]
step_pin: PA4
dir_pin: PA6
enable_pin: PA2
# 8.75 steps per mm, 32 microsteps: 1/(8.75*32)
step_distance: 0.00357143
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: PB4
sensor_type: ATC Semitec 104GT-2
sensor_pin: PK5
pullup_resistor: 4700
inline_resistor: 0
control: pid
pid_Kp: 24.258
pid_Ki: 1.071
pid_Kd: 137.359
min_extrude_temp: 170
min_temp: 12
max_temp: 280

[drv8711 extruder]
cs_pin: PL6
spi_software_sclk_pin: PD5
spi_software_miso_pin: PD4
spi_software_mosi_pin: PD6
current: 1.0

[thermistor EPCOS 100K B57550G0104]
temperature1: 25
resistance1: 100000
beta: 3066

[heater_bed]
heater_pin: PE2
sensor_type: EPCOS 100K B57550G0104
sensor_pin: PK7
control: pid
pid_Kp: 53.74
pid_Ki: 7.48
pid_Kd: 96.52
min_temp: 12
max_temp: 130

[fan]
pin: PA5
max_power: 1.0
cycle_time: 0.010
kick_start_time: 0.100
off_below: 0.0

#[controller_fan E3Dv6_fan]
#pin: PA7
#fan_speed: 1.0
#heater: extruder

[display]
lcd_type: hd44780
rs_pin: PK1
e_pin: PK3
d4_pin: PF5
d5_pin: PK2
d6_pin: PA1
d7_pin: PJ3
display_group: _default_16x4

#RE=TAST3:PH0, Ok=TAST1:PG5, DN=TAST2:PB7, LE=TAST4:PB5, UP=TAST5:PL7,
#PAUSE=TAST_E5:PH7, Z-DN=TAST_E2:PJ4, CONT=TAST_E6:PH2,
#F_REV=TAST_E3:PJ5, F-FWD=TAST_E4:PJ6, Z-UP=TAST_E1:PJ2
click_pin: !PG5
back_pin: !PB5
up_pin: !PL7
down_pin: !PB7
kill_pin: !PH7

[bed_mesh]
speed: 20
horizontal_move_z: 1
mesh_min: 10,50
mesh_max: 225,220
algorithm:bicubic
probe_count: 10,10
fade_start: 1.0
fade_end: 10.0

